%---------------------------------------------------------------------
%
%                          Capítulo 3
%
%---------------------------------------------------------------------

\chapter{Review Study}

\begin{FraseCelebre}
\begin{Frase}
Work It Harder Make It Better\\
Do It Faster, Makes Us stronger\\
More Than Ever Hour After\\
Our Work Is Never Over 
\end{Frase}
\begin{Fuente}
Guy Manuel de Homem-Christo and Thomas Bangalter 
\end{Fuente}
\end{FraseCelebre}

\begin{resumen}
In this chapter it is defined a model for our cognitive node. Firstly, the First Cognitive Device is evaluated
to obtain some guidelines and potential improvements in our design. The final device implementation requirements and
constraints are defined. Finally, it is carried out a discussion and evaluation about different modules, exposing different 
commercial options and coming into final decissions.
\end{resumen}


%-------------------------------------------------------------------
\section{Cognitive Wireless Sensor Network Node Model}
%-------------------------------------------------------------------
\label{cap3:sec:nodeModel}
%-------------------------------------------------------------------

Basically, the \ac{CWSN} node scheme responds to a standard \ac{WSN} model based on a microcontroller,
radio and sensor interfacing, and power supply. However, a further review shows some general differences:

\begin{itemize}

\item \emph{Multiple Radio Interfacing}: Regarding \ac{CR} capabilities for spectrum management and \ac{DSA}, the node
	must include multiple radio interfaces enabling different spectrum bands instead of a signle one. This capability
	is referred to the hardware modules. 


\item \emph{Multiple Control/Sensor Interfacing}: Since the device will serve as a standard \ac{CWSN} platform, it must
	embbed different multi-purpose undefinned interfaces\footnote{The interfaces here mentioned cover the usual peripherals
and buses such as \ac{I2C}, \ac{SPI}, \ac{UART}, \ac{USB}...}. This fact affects the hardware design of the device.

\item \emph{Protocol Stacking}: In order to enable communication over the different interfaces the model,
	must provide proper access to a the lower layers of a communication protocol to each radio interface\footnote{As it will be described,
	the communication protocol stack supposses a great software development in order to maintain a single stack shared by all the interfaces.}.
	The final implementation firmware will have to take part of this. 

\item \emph{Cognitive Layer}: To carry out all the cognition algorithms and computations. Affecting the firmware.

\end{itemize}


\figura{Vectorial/Todo}{width=.5\textwidth}{fig:CWSNnodeModel}%
{CWSN node model}
%poner una unica pila

Figure \ref{fig:CWSNnodeModel} gives a view about the basic model. It shows together software and hardware modules in a simplified way.
Additionally, cognition tasks compulsory require of several functions to take into account at the design stage: 

\begin{itemize}

\item \emph{Power consumption}. Efficiency and low-power comsupmtion are crucial following the inherent trend in \ac{WSN}. Once deployed,
	is common not having or having barely access to the nodes. Replacing batteries to an entire \ac{WSN} comes to be a kafkaesque task.
	The model should be able to  include an autonomous power supply and other functions:

\begin{itemize}
\item Transmission/reception power regulation.
\item Unused modules disconnection.
\item Power-saving sleeping modes for transceivers and microcontroller\footnote{Very common in \ac{WSN}. Devices remain asleep and wake up just on 	specified time-slots to execute their functions.}.
\end{itemize}

\item \emph{Spectrum management}. Some of the main functions to carry through:

\begin{itemize}
\item \ac{RSSI} detection.
\item Channel switching
\item Energy scans all over the available frequencies range.
\end{itemize}

\end{itemize}

All the previous considerations give support to stablish cognitive capabilities to the final application. In addition to the requirements to be defined, they will define the model of the final \ac{CNGD} implementation.

%-------------------------------------------------------------------
\section{First Cognitive Device review}
%-------------------------------------------------------------------
\label{cap3:sec:fcdEvaluation}
%-------------------------------------------------------------------

\figura{Vectorial/Todo}{width=.8\textwidth}{fig:fcdnode}%
{Picture of the FCD, developed at LSI in 2011}

The \ac{FCD} was developed in 2011 at the \ac{LSI} by Fernando Lopez Lara\cite{ferpfc} \cite{fcd}. 
It suppossed the first hardware platform oriented to \ac{CWSN} development.
Integrating hardware and software, it gave the chance to develop and test algorithms,
strategies and and applications for \ac{CWSN}. Moreover, it allowed to analyse 
suitability for radio interfaces, computating capability. It gave the strengths and weaknesses to stablish
the fundamentals on future designs. 


** HABLAR UN POQUITO DE LAS CARENCIAS GENERALES Y DE LA EVALUACION QUE HACE JUAN EN SU PFC
 

The \ac{FCD} has a Microchip \ac{PIC} hosting a \ac{MIPS} M4K, a 32-bits \ac{MCU} unit developed by MIPS Technologies. It has a 
Hardvard architecture employing a five-stages pipeline and a \ac{RISC}. The chosen model, a PIC32MX795F512H******REF, integrates a 512 KB
 Flash Memory and a 128 KB general purpose \ac{SRAM}. It allows a maximum 80 MHz clock frequency and it achieves a throughput as high as 1.65 DMIPS/MHz.
\footnote{}
This \ac{PIC} was found to offer too high features for our requirements, hence existing a reducible amount of power consumption 
on this module. Reducing capacity with regards to Flash and \ac{RAM} memory is seen as a positive option.  

The \ac{FCD} included three radio interfaces enabling access to two different spectrum regions. Two of the selected interfaces
work on the 2.4 GHz band and the third one over the 868 MHz, corresponding to the \ac{ISM} bands in Spain. Over the 868 MHz band
used to operate a Tulio$^{TM}$****REF**** transceivers\footnote{A radio interface developed by \ac{AWD}, a spin-off originated at \ac{LSI}, 
oriented on solutions for energy efficiency, industrial control and intelligent environments.} oriented to \ac{LOWPAN} and IEEE 802.15.4
compatible. For the 2.4 GHz band, two Microchip modules were selected, a MRF24J40*****REF module using Microchip propietary protocols such us 
MiWi$^{TM}$ P2P, MiWi$^{TM}$ Mesh, MiWiPRO$^{TM}$*************REFS and a MRF24WB0MA module IEEE 802.11 compatible as WiFi.
Firmware running on the \ac{FCD} operated by using three different protocol stacks. Tulio$^{TM}$ firmware was provided by \ac{AWD} and the 
communications to the main controller take place through an \ac{UART}. Stacks for MiWi and TCP/IP protocols are provided freely by Microchip,
being the first one significantly lighter and simpler than the second one. Communications to these transceivers use \ac{SPI} interfaces.

The Tulio$^{TM}$ module offers a very low-consumption but it contains a Texas Instrumen microcontroller increasing complexity on 
the PIC to transceiver communications, moreover, this fact raise the global consumption up. Maintaining this interface will be disputed.
On the other hand, the WiFi interface seems to be inappropiate for \ac{WSN} due to its high power consumption and hibernation-related problems,
besides its complex, resources-consumming communication stack. Even though this interface acts as a gateway, new options are highly needed. MRF24J40 gives a throughput suitable for the already described requirements, thus it could be a good candidate for the new design.

Regarding firmware options, the situation resulting from combining three different stacks becomes messy, confussing, power and resouces-consumming,
not suitable to deal with an application layer and a cognitive layer properly. Hence, using the developed \ac{HAL}\cite{juanpfc} integrating
three stacks and presenting a straightforward \ac{API} for upper layers better operation seems a good choice for this work.

The node comprises two \ac{USB} terminals and a RS232 interface for debugging and interconnection purposes. Power supply system accepts 3.3 V and 5 V options including a voltage regulator and a charge pump.

Maintaining all these interfaces supposes larger device size and greater power consumption. A review about keeping all them as well as all the power supply options will be brought to pass, some of them seemed unuseful and innefficient.

Regarding other issues, reducing the general size, making the device more scalable or modular are indeed needed on the \ac{CNGD}.

\figura{Vectorial/Todo}{width=.8\textwidth}{fig:fcdmodel}%
{Architecture model of the FCD, developed at LSI in 2011}

%-------------------------------------------------------------------
\section{System Requirements}
%-------------------------------------------------------------------
\label{cap3:sec:systemRequirements}
%-------------------------------------------------------------------


Once described the \ac{CWSN} node model and after evaluating the \ac{FCD} it is time to define the requirements for our \ac{CNGD}.
Gathered, reserarchers at \ac{LSI} specialiced on \ac{CWSN}, dicussed and shared impressions about the requirements that
the \ac{CNGD} should meet. These were classified as follows:

\begin{itemize}

\item Essential requirements

\begin{itemize}

\item Work, at least, over two \ac{ISM} bands (868 MHz and 2.4 GHz). Having, as far as possible, fully-configurable transceivers.
\item \emph{Modularity}.
\item Posibilidad de conectarse algún nodo con 802.11
\item External pluggable antenna possibilities.
\item Development tools (traces)
\item Working under a single development framework.
\item Tiene que servir como prueba de concepto de diferentes estrategias de

        Seguridad

        Bajo consumo

        Sincronización

        Calidad de Servicio (fiabilidad)

\end{itemize}
\item Desirable features
\begin{itemize}

  \item Posibilidad de conectarse tanto a una fuente de alimentación como a una batería

  \item Remote application-loader.

  \item Reduced size, oriented to development.

  \item Working over three \ac{ISM} bands (433 MHz, 868 MHz, 2.4 GHz).

  \item Monocore-based arquitechture.

  \item Battery charge monitoring.

  \item Posibilidad de conmutación real de cabezales radio -> Un transceiver para distintas frecuencias


\end{itemize}
\end{itemize}


Furthermore, it should responds to \ac{WSN} requirements:

\begin{itemize}
\item \emph{Scalability}. Given the pontentially large amount of nodes compossing a \ac{WSN}, the model call for a easily scalable design.

\item  \emph{Cost}. Due to the same previous reason, low-cost is a requirement. Otherwise their price makes networks non-commercially-viable.
        Bajo consumo


\item \emph{Throughput}. It must be slightly higher than usual. Regarding the generic nature of the platform it should be prepared for the widest
	possible range of applications. Cognition, on the other hand, increases as well the need for computation capabilities dealing with 
	several interfaces and increasing the number of data transmissions.

\item \emph{Communication data-rate}.

\item \emph{Security}.


\item \emph{Ubiquitous computing.}.

\end{itemize}



    


%Decisiones de diseño

 %   Hacer toda la placa con arquitectura PIC (Microchip)

  %  Eliminar Tulios -> Sustituir por transceiver de Microchip

   % Añadir un transceiver a 433MHz

    %Fusionar e integrar lo más posible todas las pilas

    %Analizar la influencia de los distintos tipos de antena

   % Se utilizará el hardware disponible hasta que no se pueda seguir trabajando y se haga una nueva placa




%-------------------------------------------------------------------
\section{Technology}
%-------------------------------------------------------------------
\label{cap3:sec:technology}
%-------------------------------------------------------------------

%-------------------------------------------------------------------
\subsection{Microcontroller}
%-------------------------------------------------------------------

%-------------------------------------------------------------------
\subsection{Radio Interfaces}
%-------------------------------------------------------------------

%-------------------------------------------------------------------
\subsection{Serial Communication}
%-------------------------------------------------------------------

%-------------------------------------------------------------------
\subsection{Power Supply System}
%-------------------------------------------------------------------

%-------------------------------------------------------------------
\subsubsection{Consumption}
%-------------------------------------------------------------------

%-------------------------------------------------------------------
\subsection{Timing}
%-------------------------------------------------------------------

%-------------------------------------------------------------------
\subsection{Application Capabilities}
%-------------------------------------------------------------------

%-------------------------------------------------------------------
\section{Conclusions}
%-------------------------------------------------------------------
\label{cap3:sec:conclusions}
%-------------------------------------------------------------------

Design decisions

%-------------------------------------------------------------------
%\section*{\NotasBibliograficas}
%-------------------------------------------------------------------
%\TocNotasBibliograficas
%Citamos algo para que aparezca en la bibliografía\ldots
%\citep{ldesc2e}

%\medskip

%Y también ponemos el acrónimo \ac{CVS} para que no cruja.

%Ten en cuenta que si no quieres acrónimos (o no quieres que te falle la compilación en ``release'' mientras no tengas ninguno) basta con que no definas la constante \verb+\acronimosEnRelease+ (en \texttt{config.tex}).


%-------------------------------------------------------------------
%\section*{\ProximoCapitulo}
%-------------------------------------------------------------------
%\TocProximoCapitulo

%...

% Variable local para emacs, para  que encuentre el fichero maestro de
% compilación y funcionen mejor algunas teclas rápidas de AucTeX
%%%
%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../Tesis.tex"
%%% End:
